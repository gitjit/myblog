<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=content-type content="text/html"><meta name=viewport content="width=device-width,initial-scale=1"><title itemprop=name>Python : Using Beautiful Soup | Jithesh</title>
<meta property="og:title" content="Python : Using Beautiful Soup | Jithesh"><meta name=twitter:title content="Python : Using Beautiful Soup | Jithesh"><meta itemprop=name content="Python : Using Beautiful Soup | Jithesh"><meta name=application-name content="Python : Using Beautiful Soup | Jithesh"><meta property="og:site_name" content><meta name=description content><meta itemprop=description content><meta property="og:description" content><meta name=twitter:description content><meta property="og:locale" content="en-us"><meta name=language content="en-us"><link rel=alternate hreflang=en-us href=https://jithesh.blog/posts/archives/python-beautiful-soup/ title=English><meta property="og:type" content="article"><meta property="og:article:published_time" content=2011-04-04T00:00:00Z><meta property="article:published_time" content=2011-04-04T00:00:00Z><meta property="og:url" content="https://jithesh.blog/posts/archives/python-beautiful-soup/"><meta property="og:article:author" content="Jithesh Chandrasekharan"><meta property="article:author" content="Jithesh Chandrasekharan"><meta name=author content="Jithesh Chandrasekharan"><script defer type=application/ld+json>{"@context":"http://schema.org","@type":"Article","headline":"Python : Using Beautiful Soup","author":{"@type":"Person","name":""},"datePublished":"2011-04-04","description":"","wordCount":569,"mainEntityOfPage":"True","dateModified":"2011-04-04","image":{"@type":"imageObject","url":""},"publisher":{"@type":"Organization","name":"Jithesh"}}</script><meta name=generator content="Hugo 0.134.0"><meta property="og:url" content="https://jithesh.blog/posts/archives/python-beautiful-soup/"><meta property="og:site_name" content="Jithesh"><meta property="og:title" content="Python : Using Beautiful Soup"><meta property="og:description" content="This post is about using BeautifulSoup and requests module in python application for webscrapping. We are writing a simple weather application that uses request module to html page from a website and then uses BeautifulSoup to scrap the web and to capture weather info at a particular zip code. After reading this post you will get a basic idea on how to use Beautiful Soup and requests module in python."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2011-04-04T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python : Using Beautiful Soup"><meta name=twitter:description content="This post is about using BeautifulSoup and requests module in python application for webscrapping. We are writing a simple weather application that uses request module to html page from a website and then uses BeautifulSoup to scrap the web and to capture weather info at a particular zip code. After reading this post you will get a basic idea on how to use Beautiful Soup and requests module in python."><link rel=canonical href=https://jithesh.blog/posts/archives/python-beautiful-soup/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css><link rel=stylesheet href=/css/copy-code.css><script src=/js/copy-code.js></script><link href=/style.min.da54ed9132d4ba2c4d0207a1ff9b3f2dd73aeec7858814832b1bb2bb3d91ba97.css rel=stylesheet><link href=/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css rel=stylesheet><link href=/sass/custom.min.cf467393bd3e3fc9a644f66d33a0a37039ba0d42650e5bc986be04542577c0a0.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=mask-icon href=/icons/safari-pinned-tab.svg><link rel="shortcut icon" href=/favicon.ico><link rel=manifest href=https://jithesh.blog/site.webmanifest><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#434648"><link rel=icon type=image/svg+xml href=/icons/favicon.svg></head><body data-theme class=notransition><script src=/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script><div class=navbar role=navigation><nav class=menu aria-label="Main Navigation"><a href=https://jithesh.blog/ class=logo><svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><title>Home</title><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
</a><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="25" height="25" stroke="currentcolor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7H3.40726"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M.5 12.5V1.5c0-.552285.447715-1 1-1h11C13.0523.5 13.5.947715 13.5 1.5v11C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C.947715 13.5.5 13.0523.5 12.5z"/></svg></span></label><div class=trigger><ul class=trigger-container><li><a class=menu-link href=/>Home</a></li><li><a class="menu-link active" href=/posts/>Posts</a></li><li><a class=menu-link href=/categories/>Tags</a></li><li><a class=menu-link href=/pages/about/>About</a></li><li class=menu-separator><span>|</span></li></ul><a id=mode href=#><svg class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg><svg class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg></a></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article><header class=header><h1 class=header-title>Python : Using Beautiful Soup</h1><div class=post-meta><time datetime=2011-04-04T00:00:00+00:00 itemprop=datePublished>Apr 4, 2011</time></div></header><div class=page-content><p>This post is about using <code>BeautifulSoup</code> and <code>requests</code> module in python application for webscrapping.
We are writing a simple weather application that uses request module to html page from a website and then uses
<code>BeautifulSoup</code> to scrap the web and to capture weather info at a particular zip code. After reading this post
you will get a basic idea on how to use <code>Beautiful Soup</code> and <code>requests</code> module in python.</p><p>Note :<em>I have recently updated this post to use BS4 and requests</em>.</p><p>Beautiful Soup sits atop an HTML or XML parser, providing Pythonic idioms for iterating, searching, and modifying the parse tree.
Requests is a module that makes sending http requests simple.So first step is to include these packages as part of our project and
using it. We will use <code>pip</code> to install the packages.</p><pre class=line-numbers>
<code class=language-bash>
    pip install beautifulsoup4    
    pip install requests
</code>
</pre><pre class=line-numbers>
<code class=language-python>
import requests
from bs4 import BeautifulSoup
import  collections

</code>
</pre><p>We will be using <a href=https://www.wunderground.com>weather-underground</a> to determine the conditions at a particular location.
For the sake of our application goal, instead of using their web service we will be downloading the html and parsing that to
determine the weather. If you pass zip code along with a base url, weather underground will display weather at that location
as shown below.</p><img src=2017-04-18-15-48-39.png class=img-responsive><p>As a first step, let us get the zip code from user.</p><pre class=line-numbers>
<code class=language-python>
def get_zip():
    zip_code = input("Enter your zip code : ")
    return  zip_code
</code>
</pre><p>Now download the html from url using <code>requests</code> and parse it using BS4.</p><pre class=line-numbers>
<code class=language-python>

def get_url_html(url):
    response = requests.get(url)
    # response.status_code 200 OK
    # returns html
    return response.text

</code>
</pre><p>I uses Chrome developer tool to inspect the html source and determine whilch html element has required info. First item I am trying
to read is the city name and it resides in an <code>H1</code> tag inside a div with <code>id="location"</code>. In a similar way &lsquo;condition&rsquo; is in a div
with <code>id='curCond'</code> and <code>class = 'wx-value'</code> and so on.. So based on html and css info let us grab required information from the web page.</p><pre class=line-numbers>
<code class=language-python>
def get_weather_from_html(html):
    soup = BeautifulSoup(html,'html.parser')
    loc = soup.find(id='location').find('h1').get_text().strip()
    loc = get_city(loc)
    condition = soup.find(id='curCond').find(class_ ='wx-value').get_text()
    condition = clean_text(condition)
    temp = soup.find(id='curTemp').find(class_ ='wx-data').find(class_ = 'wx-value').get_text()
    temp = clean_text(temp)
    unit = soup.find(id='curTemp').find(class_ ='wx-data').find(class_ = 'wx-unit').get_text()
    unit = clean_text(unit)
    # print("Weather @ {0} : Temperature = {1}{2} {3}".format(loc, temp, unit, condition))
    # return named tuple
    w_report = WeatherReport(location=loc, temperature=temp, scale=unit, cond=condition)
    return w_report
</code>
</pre><p>Above function returns results as a named tuple, which is easy when we are passing large result as a tuple.
This is how we create a <code>namedtuple</code>. It is part of collections module.</p><pre class=line-numbers>
<code class=language-python>
# create a named tuple for returning multiple values
WeatherReport = collections.namedtuple('WeatherReport', 'location, temperature, scale, cond')
</code>
</pre><p>Its also important that results might need some clean up. For example city name we got back is
having new line character and we need to do some clean up there.</p><pre class=line-numbers>
<code class=language-python>
def clean_text(text: str):
    if not text:
        return text
    return text.strip() 

def get_city(text: str):
    if not text:
        return text
    text = clean_text(text)
    parts = text.split('\n')
    return parts[0]
</code>
</pre><p>Given below is the <code>__main__</code> entry.</p><pre class=line-numbers>
<code class=language-python>
if __name__ == '__main__':
    print_header()
    zip_code = input("Enter your zip : ")
    url = base_url+'/'+zip_code
    html = get_url_html(url)
    w_report = get_weather_from_html(html)
    print("The weather in {} is {}{} and {}".format(w_report.location, w_report.temperature,
                                                    w_report.scale, w_report.cond))
</code>
</pre><h5 id=result>Result</h5><pre class=line-numbers>
<code class=language-bash>
--------------------------------------
            Weather App
--------------------------------------

Enter your zip : 92127
The weather in San Diego, CA is 75.8°F and Clear

Process finished with exit code 0
</code>
</pre><p><em>Coding is fun enjoy&mldr;</em></p></div></article></main></div><footer class=footer><span class=footer_item></span>&nbsp;<div class=footer_social-icons><a href=https://github.com/gitjit target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://twitter.com/jitbytes target=_blank rel="noopener noreferrer me" title=Twitter><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</a><a href=https://www.linkedin.com/in/jitheshc target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div><small class=footer_copyright>© 2024 Jithesh Chandrasekharan.</small></footer><script src=https://jithesh.blog/js/main.min.4ee188e1744c19816e95a540b2650ed9f033ea0371e74eac8e717355cfca8741.js integrity="sha256-TuGI4XRMGYFulaVAsmUO2fAz6gNx506sjnFzVc/Kh0E="></script></body></html>